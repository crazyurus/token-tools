$(document).ready(function(){var a="";$("#img_preview").fancybox();$("#btn_url_encode").click(function(){var b=$("#txt_url").val().trim();$("#txt_url").val(encodeURIComponent(b))});$("#btn_url_decode").click(function(){var b=$("#txt_url").val().trim();if(Token.check.url(b)){return}$("#txt_url").val(decodeURIComponent(b))});$("#btn_base64_encode").click(function(){var b=$("#txt_base64_encode").val().trim();$("#txt_base64_decode").val(Base64.encode(b))});$("#btn_base64_decode").click(function(){var b=$("#txt_base64_decode").val().trim();$("#txt_base64_encode").val(Base64.decode(b))});$(".btn-group label").click(function(){a=$(this).text().trim()});$("#btn_hash_calc").click(function(){var b=$("#txt_hash").val().trim();if(b==""){Token.message.alert("请输入需要计算的文本值")}else{if(a==""){Token.message.alert("请选择哈希函数")}else{Token.ajax("{:U('Tools/Encode/hash', '', '.do')}",{text:b,hash:a},function(c){$("#txt_hash_result").val(c)})}}});$(".dropdown-scroll > li").click(function(){var b=$(this).text().trim();$("#hash_more_name").html(b);$(".btn-group label").removeClass("active");$(".dropdown-toggle").addClass("active");a=b});$("#txt_pic_url").change(function(){var e=$(this).val();var c=$("#img_preview");if(e==""){$("#btn_pic_encode").attr("disabled","disabled");$("#btn_pic_show").attr("disabled","disabled")}else{$("#btn_pic_encode").removeAttr("disabled");$("#btn_pic_show").removeAttr("disabled");c.attr("title",Token.tools.getFileName($(this).val()));if($(this).attr("type")=="file"){if(Token.support.fileReader()){var b=this.files[0];if(/image\/\w+/.test(b.type)){var d=new FileReader();d.readAsDataURL(b);d.onload=function(){c.attr("src",this.result)}}}else{Token.message.alert("当前浏览器无法读取本地图片")}}else{c.attr("src",e)}}});$("#btn_pic_show").click(function(){$("#img_preview").click()});$("#img_preview").load(function(){$(this).parent().removeClass("has-error has-feedback")}).error(function(){$(this).val("");$("#txt_pic_url").focus().select();$(this).parent().addClass("has-error has-feedback")});$("#btn_pic_list li").click(function(){$("#btn_pic_choose > span:first").text($(this).text());$("#txt_pic_url").val("");$("#txt_pic_url").attr("type",$(this).data("type"))});$("#btn_pic_encode").click(function(){if($("#txt_pic_url").attr("type")=="file"){$("#txt_pic_decode").val($("#img_preview").attr("src"))}else{if(Token.support.canvas()){var b=document.createElement("canvas");var c=new Image();ctx=b.getContext("2d");c.onload=function(){b.height=c.height;b.width=c.height;ctx.drawImage(c,0,0);$("#txt_pic_decode").val(b.toDataURL("image/"+Token.tools.getFileType($("#img_preview").attr("src"))));b=null};c.src=Token.variable.app+"/tools/encode/image.action?url="+encodeURIComponent($("#img_preview").attr("src"))}else{Token.message.alert("当前浏览器不支持图片编码功能")}}})});